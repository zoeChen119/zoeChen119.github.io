---
title: 图神经网络
date: 2022-10-20 13:56:56 +/-0800
categories: [NLP,模型研究]
tags: [图神经网络]     # TAG names should always be lowercase
---

# 图神经网络

记录日期：2022/10/20
                                                                                              

* * *



    📃参考文章
    [^GCN&GNN]:https://blog.csdn.net/kc7w91/article/details/121595567

#### 欧几里得数据&非欧几里得数据：

* 欧几里得数据：排列整齐的数据
  
> 这类型的数据排列整齐，不同样本之间可以容易的定义出“距离”这个概念出来。我们且思考，假设现在有两个图片样本，尽管其图片大小可能不一致，但是总是可以通过空间下采样的方式将其统一到同一个尺寸的，然后直接逐个像素点进行相减后取得平方和，求得两个样本之间的欧几里德距离是完全可以进行的。
  
* 非欧几里得数据:排列不整齐的数据
  
  > 对于数据中的某个点，难以定义出其邻居节点出来，或者是不同节点的邻居节点的数量是不同的[5]，这个其实是一个特别麻烦的问题，因为这样就意味着难以在这类型的数据上定义出和图像等数据上相同的卷积操作出来，而且因为每个样本的节点排列可能都不同，比如在生物医学中的分子筛选中，显然这个是一个Graph数据的应用，但是我们都明白，不同的分子结构的原子连接数量，方式可能都是不同的，因此难以定义出其欧几里德距离出来，这个是和我们的欧几里德结构数据明显不同的。**因此这类型的数据不能看成是在欧几里德样本空间中的一个样本点了，而是要想办法将其嵌入(embed)到合适的欧几里德空间后再进行度量。而我们现在流行的Graph Neural Network便可以进行这类型的操作。**

如何处理 非欧式空间 的结构（典型：社交网络）？——引入了GNN与GCN网络：利用『边的信息』对『节点信息』进行『聚合』从而生成新的『节点表示』。

## 图卷积网络GCN
CNN中的卷积是一种离散卷积（即加权求和），本质上就是利用一个共享参数的过滤器（kernel），通过计算中心像素点以及相邻像素点的加权和来构成feature map、实现空间特征的提取，其中的加权系数就是卷积核的权重系数(W)。


## 图神经网络GNN[^自然语言处理中的图神经网络]

NLP任务中，文本序列是由**token包/词袋**，例如BoW,TF-IDF
> bag of tokens：最简单的方式是将自然语言表示为一袋tokens，这种方式完全忽略了文本中tokens出现的具体位置，而只考虑其在文本中出现的次数。采取这种观点的最具代表性的NLP技术是话题模型。[^面向NLP的GNNs论文解读]


->而随着**词嵌入**技术的成功，句子被表示为一个tokens序列,它通过预测目标单词的上下文单词来学习单词嵌入。
->利用文本序列中的**句子结构信息**，即依存树和选区分析树等句法分析树，通过以下2种方法
  1. 合并**特定任务的知识**来扩充原始序列数据。
  2. 用**序列数据中的语义信息**（即语义解析图，如抽象意义表示图和信息提取图）来增强原始序列数据
   > 常见的文本或知识的图表示包括依赖图、成分图、AMR图、IE图、词汇网络和知识图谱。此外，还可以构建一个包含多个层次元素的文本图，如文档、段落、句子和单词。与上述两种观点相比，这种自然语言的观点能够捕捉到文本元素之间更丰富的关系。许多传统的基于图的方法（如随机游走、标签传播）已经成功地应用于具有挑战性的NLP问题，包括词义消歧、命名消歧、共指解决、情感分析和文本聚类。

然后，这些图结构的数据可以编码实体tokens之间复杂的成对关系，以便学习更多的语义。

**But**
基于序列数据的深度学习网络不能直接适用于图结构数据。

<font color=ForestGreen>因此产生了以下挑战：
* **<font color=ForestGreen>如何自动将原始文本序列数据转换为高度图结构化的数据</font>**
* **<font color=ForestGreen>如何正确地确定图表示学习技术</font>**:需要使用专门设计的GNN来学习不同图结构数据的独特特征，如无向、有向、多关系和异质图。
* **<font color=ForestGreen>如何高效地建模复杂数据</font>**:因为许多NLP任务涉及学习基于图的输入和高度结构化的输出数据之间的映射，如序列、树，以及具有多种类型节点和边的图数据。</font>

### Research Background

#### 传统基于图的算法
1. 基于随机游走的图算法
2. 图聚类算法
3. 图匹配算法
4. 标签传播算法

这些传统的基于图的方法在NLP领域有其局限性，比如表征能力弱以及没有统一的学习架构。

#### 图神经网络基础
:cat:输入的是图。

##### Graph filtering

![](/assets/img/2022-10-20-图神经网络/2022-10-20-17-56-53.png)
<center>图谱过滤的分类以及一些代表方法</center>

1. spectral-based:基于谱图理论
2. spatial-based:利用其空间近邻节点来计算该节点的嵌入表示
3. attention-based：将不同的注意力权重分配给不同的邻居节点
4. recurrent-based：门控机制，模型参数在不同的GNN层之间共享

##### Graph pooling
图谱池化层是为了以图为中心的下游任务来生成图级的嵌入表示。
例如：图的分类-依据从图谱过滤中学习到的节点嵌入表示来进行预测的。
（这是因为对于以节点为中心的任务来说，学习到的节点嵌入表示已经足够了。然而，对于以图为中心的任务，需要整个图的嵌入表示。）
池化操作就是为了总结节点嵌入信息和图结构信息。
图池化层可以分为两类：平面图池化（flat pooling）和分层图图池化（hierarchical pooling）。

1. flat pooling
   平面图池化直接从每步中的节点单独嵌入。
2. hierarchical pooling
   分层图池化包含几个图池化层，每个池化层之后又有好多图过滤器。

### 面向NLP的GNNs分类[^面向NLP的GNNs分类]
![](/assets/img/2022-10-20-图神经网络/2022-10-20-17-49-35.png)
<center>图1. NLP中GNNs三个方面的研究以及GNN的应用</center>


#### 图的构造
:wind_chime:输入是文本序列

:interrobang:How？
    文本序列-------》图输入

构建方法合集：
![](/assets/img/2022-10-20-图神经网络/2022-10-20-19-32-38.png)

##### 1.静态图构建
利用现有的**关系解析工具**（例如：依存解析）或**手动定义的规则**在预处理过程中构造图结构。
静态图可以为原始文本序列引入隐藏的领域或外部知识，用丰富的结构化信息来扩充原始文本。
   - dependency graph:

    依赖图通常用于捕捉给定句子中不同对象之间的依赖关系。
    具体流程为：给定一个段落---》使用各种NLP解析工具（例如Stanford CoreNLP）获得依存分析树（例如句法依存树或语义依存关系树）---》从依存分析树中提取依赖关系，并将依赖关系转换为依赖性图。
    
    PS.文本有“顺序信息”，而图节点是无序的，可以引入顺序的link，在图结构中保留“顺序信息”。

概括一下流程为：
    1）构建依赖关系，2）构建顺序关系，3）最终的图转换。

   - constituency graph

    成分图通常用于捕捉一个或多个句子中基于短语的句法关系。
    
    PS.与依存分析不同的是，依存分析只关注单个词之间一对一的对应关系（即词级），而构成分析则对一个或几个对应词的组合进行建模（即短语级）。

成分关系的基本概念：在语言学中，成分关系是指**遵循短语结构语法的关系**，而不是依存关系和依存语法。一般来说，成分关系是由主语（名词短语NP）— 谓语（动词短语VP）关系衍生出来的。

    PS.与依存关系解析树不同的是，所有的节点都有相同的类型，成分分析树区分了终端节点和非终端节点，非终端类别标记分析树的内部节点，叶子节点标记为终端类别。

节点集可以表示为：1）非终端节点集2) 终端节点集。
构成关系集合与树的边相关。成分图由非终端节点和终端节点组成，以及成分边和序列边。对于原文中相邻的每个单词节点对，在它们之间添加一条具有特定序列类型的无向边，用来保留顺序信息。


  ![](/assets/img/2022-10-20-图神经网络/2022-10-20-19-38-24.png)
  <center>图2 Dependency Graph and Constituency Graph Construction</center>

   - AMR graph
    AMR图是有根、有标注、有向、无环的图，它被广泛用于表示非结构化的具体自然文本的抽象概念之间的高级语义关系。
      :yellow_heart:与句法上的特异性不同，AMR是高层次的语义抽象。:yellow_heart:
更具体地说，在语义上相似的不同句子可能共享相同的AMR解析结果，例如，"保罗描述自己是一个战士 "和 "保罗对自己的描述：一个战士"，如图3所示。与之前介绍的依赖树和成分树类似，AMR图是由AMR解析树衍生出来的。

  ![](/assets/img/2022-10-20-图神经网络/2022-10-20-19-38-36.png)

   - 信息抽取图构建（Information Extraction Graph Construction）

![](/assets/img/2022-10-20-图神经网络/2022-10-20-20-52-36.png)
<center>图4 Information Extraction Graph</center>

信息抽取图（IE Graph）旨在提取结构信息来表示自然句子之间的高级信息，例如基于文本的文档。
这些提取出来的关系，捕捉到远距离句子之间的关系，在许多NLP任务中很有帮助。在下文中，为给定段落构建IE图的过程分为三个基本步骤。1）指代消解，2）构建IE关系，3）图的构建。

   - 话语图构建（Discourse Graph Construction）
    当候选文档太长时，许多NLP任务会受到长距离依赖性的挑战。话语图描述了两个句子之间的逻辑联系，可以有效地解决这种挑战。

   - 知识图谱构建（Knowledge Graph Construction）
    ![](/assets/img/2022-10-20-图神经网络/2022-10-20-19-38-48.png)

捕捉实体和关系的知识图谱（KG）可以大大促进许多NLP应用中的学习和推理。KG可以表示为G(V, E)，它通常由知识库中的元素构建。形式上，定义三元组作为知识库的基本元素，包括是源实体，目标实体和关系类型。然后，在知识库中添加两个节点，即源节点和目标节点，并从节点v1到节点v2添加一条边类型为rel的有向边。

构建KG的第一件事是获取给定查询中的术语实例。然后，通过一些匹配算法（如最大子串匹配）将术语实例与KG中的概念联系起来。这些概念被看作是提取的子图中的初始节点。下一步是获取初始节点在KG中的1跳邻居。此外，人们可以通过应用一些图节点相关性模型，如个性化的PageRank（PPR）算法，来计算邻居与初始节点的相关性。然后根据结果，进一步修剪出相关性分数低于置信度阈值的边，并删除孤立的邻居。剩余的最终子图随后被用来给任何图表示学习模块提供信息。

   - similarity graph
    ![](/assets/img/2022-10-20-图神经网络/2022-10-20-20-57-03.png)

相似性图旨在量化节点之间的相似性，在许多NLP任务中被广泛使用。
由于相似性图通常是面向应用的，因此我们重点关注构建实体、句子和文档等各种类型元素的相似性图的基本程序，而忽略了具体的应用细节。
**相似性图的构建是在预处理过程中进行的，而不是以端到端的方式与其余学习系统共同训练。** 图6中显示了一个相似性图的例子。

   - 共指图构建（Coreference Graph Construction）
在语言学中，当某个段落中的两个或多个术语指代同一个对象时，就会出现共指。许多工作表明，这种现象有助于更好地理解语料库的复杂结构和逻辑，解决歧义。为了有效地利用共指信息，共指图用来显式的建模隐性共指关系。给定一组短语，共指图可以连接文本语料库中指代同一实体的节点（短语）。

   - 共现图构建（Co-occurrence Graph Construction）
    ![](/assets/img/2022-10-20-图神经网络/2022-10-20-20-58-58.png)
共现图旨在捕捉文本中词与词之间的共现关系，这在许多NLP任务中被广泛使用，共现关系描述了在固定大小的上下文窗口内共同出现的两个词的频率，是捕捉语料库中词之间语义关系的一个重要特征。共现图的例子见图7
   - topic graph
    ![](/assets/img/2022-10-20-图神经网络/2022-10-20-20-59-42.png)

话题图是建立在几个文档上的，其目的是**对不同话题之间的高层次语义关系进行建模**。
给定一组文档，首先用一些话题建模算法，如LDA，学习潜在的话题。
然后构建话题图，只有当文档具有该话题时，那么在文档节点和话题节点之间构建一条无向边。

   - 应用驱动图构建（App-driven Graph Construction）
    ![](/assets/img/2022-10-20-图神经网络/2022-10-20-21-00-59.png)

应用驱动图指的是为**特定的NLP任务专门设计的图**。在一些NLP任务中，用特定应用的方法通过结构化的形成来表示非结构化的数据是很常见的。例如，SQL语言可以自然地通过SQL解析树来表示。因此，它可以被转换为SQL图。由于这些图在领域知识的基础上过于专业化，所以没有统一的模式来总结如何建立一个应用驱动的图。图9是这种应用驱动图的一个例子，如SQL图。

---

大部分静态图构造方法只考虑节点之间的某些特定关系，构建的图在一定程度上很好地捕捉到了结构信息，但没法直接利用多种不同类型的图关系。

:interrobang:How？
将多个图组合起来构建混合图？（这样能丰富图中的语义信息）

静态图构建的问题/缺陷：
首先，为了构建合理性能的图拓扑结构，需要广泛的人力和专业知识领域。
其次，手动构建的图结构可能容易出错（例如，嘈杂或不完整性）。
第三，由于图构建阶段和图表示学习阶段是不相交互的，因此在图构建阶段引入的错误无法被纠正，可能会累积到以后阶段，进而会导致性能下降。
最后，图的构建通常是由机器学习从业者提供见解信息，这对下游预测任务可能不是最理想的。

为了解决上述问题，提出了动态图构建方法:point_down:

##### 2.动态图构建
大多数动态图构建方法旨在动态地学习图结构（即加权邻接矩阵），图构建模块可以与后续的图表示学习模块共同优化，从而以端到端的方式完成下游任务。

下面两个组件是动态图构建的两个部分，（不是两种方法）

- 图谱相似性度量学习方法similarity metric learning
    图相似度度量学习组件用于学习嵌入空间中的成对节点相似性的邻接矩阵


- 图谱稀疏化方法graph sparsity
    稀疏化组件用于从全连接图中提取稀疏图。


![](/assets/img/2022-10-20-图神经网络/2022-10-20-19-50-50.png)


#### 图表示学习
构建好了图，接下来利用各种**图表示学习技术**进行学习和特征提取。

目标：找到一种方法可以通过机器学习模型将**图结构**和**其属性的信息**合并到低维嵌入中。

原始文本数据构建的图要么是“异构图”要么是“同构图”。
![](/assets/img/2022-10-20-图神经网络/2022-10-20-20-01-10.png)
* 同构图的各种图表示学习方法
  * 原始同构图的场景
  * 从异构图转换的场景
* 用于多关系图的基于GNN的方法
* 异构图的基于GNN方法

#### 基于图的encoder-decoder模型
![](/assets/img/2022-10-20-图神经网络/2022-10-20-20-04-40.png)
<center>包含了Graph2Seq和Graph2Tree的编码器-解码器GNN模型架构</center>

* Graph2Seq
  通常采用基于 GNN 的编码器和基于 RNN/Transformer的解码器
  与 Seq2Seq模型架构相比，Graph2Seq 更善于捕捉输入文本的丰富结构信息，可应用于任意图结构数据，而且，Graph2Seq 模型在更广泛的 NLP 任务，包括神经机器翻译，文本摘要，问题生成，图谱到文本，SQL到文本，代码摘要以及语义解析。

* Graph2Tree
  结合输入端和输出端的信息，使编码解码过程中的信息流更加完整。
  与考虑输入端结构信息的 Graph2Seq 模型相比，许多NLP 任务还包含复杂结构表示的输出，例如树结构输出（语法解析，语义解析等），它们也是结构信息丰富输出端。

#### GNNs助力NLP应用场景
![](/assets/img/2022-10-20-图神经网络/2022-10-20-20-09-31.png)
<center>GNN在NLP中的应用</center>

#### 基准数据集，评估指标


#### GNNs for NLP的挑战和未来研究方向





## Reference
[^面向NLP的GNNs分类]:《Graph Neural Networks for Natural Language Processing: A Survey》
[^自然语言处理中的图神经网络]:https://zhuanlan.zhihu.com/p/488364904
[^面向NLP的GNNs论文解读]:https://zhuanlan.zhihu.com/p/382679398