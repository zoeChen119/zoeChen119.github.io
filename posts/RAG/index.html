<!DOCTYPE html><html lang="zh-CN" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="RAG" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="RAG调研" /><meta property="og:description" content="RAG调研" /><link rel="canonical" href="https://zoechen119.github.io/posts/RAG/" /><meta property="og:url" content="https://zoechen119.github.io/posts/RAG/" /><meta property="og:site_name" content="zoe Chen" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-02-29T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="RAG" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-02-29T00:00:00+08:00","datePublished":"2024-02-29T00:00:00+08:00","description":"RAG调研","headline":"RAG","mainEntityOfPage":{"@type":"WebPage","@id":"https://zoechen119.github.io/posts/RAG/"},"url":"https://zoechen119.github.io/posts/RAG/"}</script><title>RAG | zoe Chen</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="zoe Chen"><meta name="application-name" content="zoe Chen"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.jfif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">zoe Chen</a></div><div class="site-subtitle font-italic">nlper, dler, sims4er</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/zoeChen119" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['zoe9698','163.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>RAG</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>RAG</h1><div class="post-meta text-muted"> <span> 发表于 <em class="" data-ts="1709136000" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2024-02-29 </em> </span><div class="d-flex justify-content-between"> <span> 作者 <em> <a href="https://github.com/zoeChen119">陈政伊</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5462 字"> <em>30 分钟</em>阅读</span></div></div></div><div class="post-content"><h1 id="rag调研">RAG调研</h1><h2 id="一一些共识"><span class="mr-2">一、一些共识</span><a href="#一一些共识" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>External knowledge is the key to resolving the problems of LLMs such as hallucination and outdated knowledge, which can make LLMs generate more accurate and reliable responses through retrieval-augmented generation (RAG). However, LLMs cannot always response as expected with RAG. For one thing, there are numerous irrelevant documents and false information on the Internet. Incorporating these external documents into LLMs could have a detrimental effect. For anthoer, LLMs suffer from the unreliable generation challenge. The generation of LLMs is often unpredictable, and we cannot guarantee that they will utilize the useful information entailed in the external documents. Additionally, LLMs can easily be misled by incorrect information in the document. To this end, we build RetrievalAugmented Generation Benchmark (RGB) to evaluate the retrieval-augmented generation of LLMs, and we concern about 4 specific abilities:[^Benchmarking Large Language Models in Retrieval-Augmented Generation]</p></blockquote><p>外部知识是解决幻觉和过时知识等llm问题的关键，它可以通过检索增强生成(RAG)使llm产生更准确、更可靠的响应。然而，</p><p>⭐<strong>LLM 并不总是像 RAG 预期的那样响应</strong>。</p><p>⭐<strong>将这些不相关的或者虚假的外部文档合并到 LLM 中可能会产生不利影响。</strong></p><p>⭐<strong>llm的生成通常是不可预测的，我们不能保证它们将利用外部文档中包含的有用信息。</strong></p><p>⭐<strong>LLM 很容易被文档中不正确的信息误导。</strong></p><blockquote><p>In real-world scenarios, it is not possible to obtain perfect documents with all the necessary external knowledge. Therefore, evaluating these four abilities of the model becomes essential in order to measure the RAG of LLMs.[^Benchmarking Large Language Models in Retrieval-Augmented Generation]</p></blockquote><p>⭐<strong>在现实世界的场景中，不可能获得具有所有必要的外部知识的完美文档。</strong>因此需要能够评估模型的这四个能力。</p><h2 id="二论文调研"><span class="mr-2">二、论文调研</span><a href="#二论文调研" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="benchmarking-large-language-models-in-retrieval-augmented-generationbenchmarking-large-language-models-in-retrieval-augmented-generation"><span class="mr-2">Benchmarking Large Language Models in Retrieval-Augmented Generation[^Benchmarking Large Language Models in Retrieval-Augmented Generation]</span><a href="#benchmarking-large-language-models-in-retrieval-augmented-generationbenchmarking-large-language-models-in-retrieval-augmented-generation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p align="right">---中科院计算所，23年9月4日</p><h4 id="摘要"><span class="mr-2">摘要：</span><a href="#摘要" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>检索增强生成 (RAG) 是一种<strong>减轻大型语言模型 (LLM) 幻觉</strong>的有前途的方法。然而，现有的研究缺乏对检索增强生成对不同大型语言模型的影响的严格评估，这使得识别RAG对不同llm能力的潜在瓶颈具有挑战性。在本文中，我们<strong>系统地调查了 Retrieval-Augmented Generation 对大型语言模型的影响</strong>。我们<strong>分析了不同大型语言模型在RAG所需的4个基本能力下的性能，包括噪声鲁棒性、负拒绝、信息集成和反事实鲁棒性</strong>。为此，我们<strong>建立了 Retrieval-Augmented Generation Benchmark (RGB)，这是一个用于英文和中文 RAG 评估的新语料库</strong>。RGB 根据解决案例所需的上述基本能力，将基准内的实例划分为 4 个单独的测试平台。然后我们在 RGB 上评估 6 个具有代表性的 LLM，以诊断应用 RAG 时当前 LLM 的挑战。<u>评估表明，虽然 LLM 表现出一定程度的噪声鲁棒性，但它们在负拒绝、信息集成和处理虚假信息方面仍然会遇到重大困难</u>。上述评估结果表明，在有效地将RAG应用于LLM之前，仍有相当大的旅程。</p><h4 id="introduction"><span class="mr-2">Introduction：</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>🌱为什么要研究RAG模型？</p><blockquote><p>Recently, there have been impressive advancements in large language models (LLMs) like ChatGPT (OpenAI 2022), LLaMA-2 (Touvron et al. 2023), and ChatGLM (THUDM 2023a). Although these models have shown remarkable general abilities (Bang et al. 2023; Guo et al. 2023), they still suffer severely from challenges including factual hallucination (Cao et al. 2020; Raunak, Menezes, and JunczysDowmunt 2021; Ji et al. 2023), knowledge out-dating (He, Zhang, and Roth 2022), and the lack of domain-specific expertise (Li et al. 2023c; Shen et al. 2023).</p></blockquote><p>ChatGPT、LLaMA-2、ChatGLM等大模型虽然有优秀的通用能力，但是存在一些问题，①factual hallucination事实幻觉；②knowledge out-dating知识过时；③domain-specific expertise特定领域的专业知识。</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强\RAG的研究动机-2023-12-04-1505.png" alt="RAG的研究动机-2023-12-04-1505" data-proofer-ignore></p><blockquote><p>With the help of external knowledge, LLMs can generate more accurate and reliable responses. The most common method is to use a search engine as a retriever such as New Bing.</p></blockquote><p>LLMs+RAG的一个典型应用就是New Bing。</p><blockquote><p>On the other hand, LLMs suffer from unreliable generation challenge. LLMs can be misled by incorrect information contained in the context (Bian et al. 2023) and also suffer from hallucination during the generation (Adlakha et al. 2023), resulting in generating content that goes beyond external information.</p></blockquote><p>RAG也会给LLMs带来负面影响，比如①互联网中存在虚假信息，②LLM可能会被上下文中包含的错误信息误导，③LLM在生成过程中存在幻觉，会生成超出外部信息的内容。</p><blockquote><p>Unfortunately, currently there lacks of comprehensive understanding on how these factors can influence RAG, and how could each model survives from these drawbacks and improvement their performance via information retrieval.</p></blockquote><p><strong>不幸的是，目前对这些因素如何影响RAG，以及每个模型如何从这些缺陷中幸存下来并通过信息检索提高其性能缺乏全面的了解。</strong>因此，迫切需要对LLM进行全面评估，评估其有效利用检索到的信息的能力，以及抵御信息检索中存在的各种缺点的能力。</p><p>💡为了确保LLM的内部知识不会在评估结果中引入偏差，RGB选择聚合<strong>最新的新闻信息</strong>，并基于新闻信息构建查询。然后，基于这些查询，我们使用搜索API获取相关文档，并从内容中<strong>选择最相关的片段作为外部检索文档</strong>。最后，基于查询和文档集对的不同组成，我们<strong>扩展语料库</strong>，并将其<strong>划分为4个测试平台</strong>，根据RAG中常见的挑战来评估LLM的以下基本能力，如图1所示：</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_0_Figure_1_645056946.png" alt="img" data-proofer-ignore></p><ol><li><p>噪声鲁棒性Noise Robustness：“从嘈杂文档中提取有用信息”的能力。</p><p>本文中，我们将【嘈杂的文档】定义为“与问题相关的文档，但不包含任何答案信息。”</p><p>噪声鲁棒性平台：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>所有相关外部文档=噪声文档+包含答案信息的文档
	
噪声文档=噪声比*所有相关外部文档
</pre></table></code></div></div><li><p>负拒绝Negative Rejection：“拒绝回答无答案查询”的能力</p><p>无答案查询：所需知识不存在于任何检索到的文档中。此情况，LLM应给出“信息不足”或其他拒绝信号。</p><p>负拒绝平台：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>外部文档=噪声文档
</pre></table></code></div></div><li><p>信息整合Information Integration：“回答关联多个文档的复杂问题”的能力</p><p>信息整合平台：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>查询=只能用多个文档才能回答的实例
	
外部文档=多个包含答案信息的文档+噪声文档
</pre></table></code></div></div><li><p>反事实鲁棒性Counterfactual Robustness：“通过指令提示LLMs’警告：检索到的信息存在潜在风险‘时，能够识别检索到的文档中的已知事实错误”的能力</p><p>反事实稳健性平台：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>LLM已知的知识，即可以直接回答的query。
	
外部文档=存在事实错误的文档
</pre></table></code></div></div><p>请注意，我们只评估 LLM 通过指令对检索到的信息中潜在风险的警告的情况。</p></ol><p>测评模型：</p><ol><li>ChatGPT<li>ChatGLM-6B<li>ChatGLM2-6B<li>Vicuna-7b<li>Qwen-7B-Chat<li>BELLE-7B</ol><p>结论：</p><blockquote><p>We found that even though RAG can improve the response accuracy of LLMs, they still suffer from the abovementioned challenges significantly. Specifically, we found that even though LLMs demonstrate some level of noise robustness, they tend to confuse similar information and frequently generate inaccurate answers when relevant information exists.</p></blockquote><p>尽管RAG可以提高llm的响应精度，但它们仍然受到上述挑战的显著影响。具体来说，</p><ol><li>我们发现，尽管 LLM 展示了一定程度的噪声鲁棒性，但当相关信息存在时，它们往往会混淆相似的信息并经常生成不准确的答案。</ol><p>例如，当面对有关 2022 年诺贝尔文学奖的问题时，如果有关外部文件文献中 2021 年诺贝尔奖的嘈杂文档，LLM 可能会混淆并提供不准确的答案。</p><ol><li><p>此外，当没有一个外部文档包含相关信息时，LLM 经常无法拒绝回答并生成不正确的答案。</p><li>此外，LLM 缺乏从多个文档中总结的能力，因此如果需要多个文档来回答问题，LLM 通常无法提供准确的答案。<li>最后，我们发现，即使llm包含所需的知识，并通过指令对检索到的信息中潜在风险的警告，它们仍然倾向于信任和优先考虑检索到的信息而不是他们自己的现有知识。</ol><h4 id="retrival-augmented-generation-benchmark"><span class="mr-2">Retrival-Augmented Generation Benchmark</span><a href="#retrival-augmented-generation-benchmark" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>数据集构建过程：</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_2_Figure_2_-1246759510.png" alt="img" data-proofer-ignore></p><p>News Collection–真实的</p><p>Step 0：收集最新的新闻文章</p><p>Step 1：QA实例生成（QA instances generation）：使用prompt让ChatGPT为每篇文章生成<strong>事件（Related event）、问题（Question）和答案（Key information）</strong>。这一步能够顺便初步过滤出不包含任何事件的新闻文章。</p><p>Step 2：人工检查调整、过滤<strong>难以通过搜索引擎检索的数据</strong>。</p><p>Step 3：使用搜索引擎API检索（Retrieve using search engine）：对于每个Query使用谷歌 API获取10个相关网页，并提取相应的文本片段。</p><p>Step 4：阅读这些网页，并将其文本内容转换为最大长度为300个token的文本块。使用现有的密集检索模型选择与查询最有效匹配的前30个文本块。这些检索到的文本块，以及搜索API提供的片段，将用作我们的<strong>外部文档</strong>。</p><p>Step 5：扩展语料库，为4种能力构建Testbeds（试验台）。</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>对于噪声鲁棒性，根据所需的噪声比率对不同数量的负面文档进行采样。

对于负样本拒绝，所有的外部分档都是从负文档中采样的。

对于信息整合，基于前面生成的问题构造复杂问题。这涉及到扩展或重写这些问题，使它们的答案包含多个方面。例如，“谁获得了2023年超级碗的MVP？”这个问题可以改写为“谁赢得了2022年和2023年的超级碗MVP。因此，回答这样的问题需要利用来自各种文件的信息。

对于反事实稳健性，反事实稳健性数据完全基于模型的内部知识构建，也就是说让模型自动生成已知的问题和答案，例如，基于“谁获得了 2022 年诺贝尔生理学和医学奖？”的问题，该模型将生成已知问题“谁获得了 2021 年诺贝尔文学奖？”并回答“Abdulrazak Gurnah”。然后人工验证生成的答案，并检索相关文档，为了使文档包含事实错误，我们人工修改答案并替换文档中的相应部分。
</pre></table></code></div></div><blockquote><p>密集检索模型:</p><p>for English：https://huggingface.co/sentence-transformers/all-mpnet-basev2</p><p>for Chinese：https://huggingface.co/moka-ai/m3e-base</p></blockquote><p>RGB统计数据：</p><p>共600个基本问题，200个信息整合能力的附加问题，200个反事实稳健性能力的附加问题。</p><p>所有问题，一半中文，一半英文。</p><p>评价指标：</p><p><strong>该基准的核心是评估 LLM 是否可以利用提供的外部文档来获取知识并生成合理的答案。</strong></p><ul><li><p>Accuracy：for 噪声鲁棒性、信息整合</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>精确匹配-如果生成的文本包含与答案的精确匹配，则视为回答正确。
</pre></table></code></div></div><li><p>Rejection rate：for 负样本拒绝</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>当只提供嘈杂的文档时，LLM应输出具体内容—— "I can not answer the question because of the insufficient information in documents."（“由于文档中的信息不足，我无法回答问题。”）如果模型生成此内容，则表示成功拒绝。
</pre></table></code></div></div>PS.使用说明提示模型。<li><p>Error detection rate：for 反事实鲁棒性（衡量模型是否能检测出文档中的事实错误）</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>当提供的文档包含事实错误时，模型应该输出特定的内容-"There are factual errors in the provided documents."（“提供的文档中存在事实错误”。）如果模型生成该内容，则表明模型在文档中检测到错误信息。
</pre></table></code></div></div>PS.使用说明提示模型。<li><p>Error correction rate：for 反事实鲁棒性（衡量模型是否能在识别到事实错误之后仍能提供正确的答案）</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>如果该模型生成正确的答案，则表明模型能够 修正 文档中的事实错误。
</pre></table></code></div></div>\[ACC=\frac{\#tt}{\#nums}\]<p>#tt：正确的response数量</p><p>#nums：所有待评估的❓实例数量</p></ul><p>考虑到模型可能无法完全遵守指令，对于拒绝率和错误检测率，我们还使用ChatGPT对答案进行额外评估。具体而言，❓我们通过使用指导（instructions）和演示（demonstrations）来评估模型的响应，以确定它们是否能够反映文件中没有的信息或识别任何事实错误。</p><h4 id="experiments"><span class="mr-2">Experiments</span><a href="#experiments" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h5 id="settings"><span class="mr-2">Settings</span><a href="#settings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>由于上下文限制，我们为每个问题提供<strong>5个外部文档</strong>。在我们关于噪声鲁棒性的实验中，我们评估了噪声比在0到0.8之间的场景。为了全面评估整体能力，我们<strong>对每种语言都采用了统一的指导</strong>（instructions），如图3所示。实验是使用NVIDIA GeForce RTX 3090进行的。</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_3_Figure_3_536383974.png" alt="img" data-proofer-ignore></p><p>include a system instruction followed by a user input instruction</p><h5 id="results-on-noise-robustness"><span class="mr-2">Results on Noise Robustness</span><a href="#results-on-noise-robustness" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>针对 噪声鲁棒性 实验：</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_4_Table_1_1366057918.png" alt="img" data-proofer-ignore></p><p><strong>结论</strong>：</p><ol><li><p>RAG能有效改善LLMs的响应。</p><p>即使在存在噪声的情况下，llm也表现出了很强的性能，这表明RAG是llm产生准确可靠响应的一种有希望的方法。</p><li><p>噪声率的不断提高对llm中的RAG提出了挑战。</p><p>具体来说，当噪声比超过80%时，模型的精度明显下降。例如，ChatGPT的性能从96.33%下降到76.00%，而ChatGLM2-6B的性能从91.33%下降到57.33%。</p></ol><p>深入分析这个实验中的模型答错的答案，发现错误通常源于<strong>3个原因</strong>：</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_4_Table_2_1780650320.png" alt="img" data-proofer-ignore></p><p>给出了噪声鲁棒性的误差案例，并且只给出了一个正面文档和一个负面文档。响应由ChatGLM2-6B生成。蓝色文本表示文档与问题或答案之间匹配的部分，而红色文本突出显示不匹配的部分。</p><ol><li><p>长距离信息</p><p>当外部文档中<strong>“与问题相关的信息”与“与答案相关的信息”相距甚远时</strong>，模型难以识别正确答案。这种情况中，大部分是“与问题相关的信息”首先出现在文档的开头，在下文中使用代词指代它。这种情况出现时，<strong>模型会去依赖其他文档的信息</strong>，产生错误的印象（幻觉）。</p><p>如上图中卡塔尔公开赛只在开头出现了一次，与答案文本Anett Kontaveit人名相距甚远。</p><li><p>证据的不确定性</p><p>在备受关注的事件发生前，人们倾向于<strong>预测、猜测、预言</strong>它。尽管这样的预测文档明确指出这是不确定或推测性的内容，但它们仍然会影响LLM的检索增强生成。</p><p>如上图中，错误文档中的内容都是关于苹果新耳机的预测（Apple Reality Pro），并且存在有正确答案的文档（Vision Pro），模型仍然被<strong>误导</strong>了。</p><li><p>概念混淆</p><p>外部文档中的概念可能与问题中的<strong>概念相似</strong>，但又不同。这会让LLM<strong>混淆</strong>，并生成不正确的答案。</p><p>如上图中，模型对问题的理解集中在”汽车收入“的概念上（特斯拉，收入-&gt;通常提到特斯拉都是谈论特斯拉汽车-&gt;特斯拉，汽车收入），但问题问的是特斯拉这个公司一季度全部“收入”。</p></ol><p>通过上述分析，LLM需要进一步详细的增强，比如长文档建模、精确的概念理解</p><h5 id="results-on-negative-rejection-testbed"><span class="mr-2">Results on Negative Rejection testbed</span><a href="#results-on-negative-rejection-testbed" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>针对 负拒绝 实验：（只提供负样本，看模型的拒绝率）</p><p>采用<strong>精确匹配</strong>评估拒绝率（Rej），利用<strong>ChatGPT</strong>来确定LLM的response是否包含拒绝信息（Rej*）。</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_5_Table_3_1815174249.png" alt="img" data-proofer-ignore></p><p><strong>结论</strong>：</p><ol><li><p>负拒绝对LLM中的RAG提出了挑战。</p><p>中文/英文LLM的最高拒绝率最高43.33%/45%。</p><li><p>通过比较Rej和Rej*，发现LLM不能严格遵循指令，且经常产生不可预测的response，因此LLM很难直接用来识别负样本并判定拒绝。</p></ol><p><strong>2个原因</strong>：</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_5_Table_4_-1001365273.png" alt="img" data-proofer-ignore></p><ol><li><p>证据不确定性</p><p>虽然文件中只提到与 “亚当-麦凯 “的联系，并没有明确指出他是这部电影的导演，但模型仍然断定他担任了这一角色。</p><li><p>概念混淆</p><p>答案中提供的信息与问题中提到的“2022 年冬季奥运会”而不是“2022 年奥运会”。与直接回答相比，检索增强生成对负拒绝提出了更大的挑战，因为它提供了可能误导 LLM 并导致错误响应的相关文档。</p></ol><h5 id="results-on-information-integration-testbed"><span class="mr-2">Results on Information Integration testbed</span><a href="#results-on-information-integration-testbed" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>针对 信息整合 实验：不同噪声率下，评估模型准确率。</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_6_Table_5_-1246759510.png" alt="img" data-proofer-ignore></p><p><strong>结论</strong>：</p><ol><li><p>信息整合 对于LLMs中的RAG来说是一个大挑战（<strong>LLM难以有效地整合信息，不太适合直接回答复杂的问题。</strong>）</p><p>即使噪声率=0，英文/中文中最高也只有60%/67%的准确率</p><p>添加噪声文档后，英文/中文下降到43%/55%</p><li><p>对于文档嘈杂的RAG来说，<strong>复杂的问题</strong>更具挑战性。</p><p>对比 噪声鲁棒性 实验（简单问题，添加噪声文档），如下图。简单问题时，噪声比达到0.8时，性能才显著下降，而复杂问题时，噪声比=0.4时，性能猛降。</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_4_Table_1_1366057918.png" alt="img" data-proofer-ignore></p><p>这表明复杂的问题更容易受到噪声的干扰。我们推测，这是因为解决复杂问题需要整合来自多个文档的信息，而这些信息可以被视为彼此的噪声，使模型更难从文档中提取相关信息。</p></ol><p><strong>4个原因</strong>：（这里分析的是噪声率-0的ChatGLM2-6B的错误数据）</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_6_Table_6_-1649557801.png" alt="img" data-proofer-ignore></p><ol><li><p>38%的错误实例属于 噪声稳健性 实验中发现的3个错误原因</p><li><p>合并错误（占比28%）：</p><p>模型试图合并两个子问题的答案，错误地使用一个问题的答案直接回答两个子问题，然后忽略另一个子问题相关的所有文档。</p><p>例如：模型回答D 组是法国队和德国队的世界杯小组，而实际上德国队被分到了 E 组。</p><li><p>忽视错误（28%）</p><p>模型只回答一个问题，直接忽略另一个问题。原因是模型对问题缺乏全面的理解，没有认识到问题由多个子问题组成。</p><p>例如：模型只提供了 2022 年超级碗 MVP 的答案，而没有考虑 2023 年。</p><li><p>错位误差（6%）</p><p>模型把子问题1的文档误识别为子问题2的问答，导致答案错位。</p><p>例如：模型仅提到了 2023（95）学院奖的最佳图片，完全忽略了 2022 年奖项。此外，它错误地指出，“CODA”是 2023 的最佳图片，当它实际上被授予 2022 年的最佳图片时。</p></ol><p>上述错误主要是由于对复杂问题的理解有限，这阻碍了有效利用来自不同子问题的信息的能力。<strong>关键是提高模型的推理能力。</strong>一种可能的解决方案是使用<strong>思维链方法来分解复杂问题</strong>（Zhou et al. 2023a; Xu et al. 2023b; Drozdov et al. 2023）。然而，这些方法<strong>会减慢推理速度</strong>，无法提供及时的响应。</p><h5 id="results-on-counterfactual-robustness-testbed"><span class="mr-2">Results on Counterfactual Robustness testbed</span><a href="#results-on-counterfactual-robustness-testbed" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>针对 反事实鲁棒性 实验：</p><p>（考察模型对于已知事实知识的问题，包含事实错误的噪声文档能否干扰他的思考。因此只考虑准确率超过 70% 的 LLM。）</p><p>4个指标：①不包含任何文档的准确率、②包含反事实文档的准确率、③错误识别率、④错误纠正率</p><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强ccbadec7b7dfc8af05d8871f80c3983_6_Table_7_2078354437.png" alt="img" data-proofer-ignore></p><p>采用<strong>精确匹配</strong>评估错误识别率（ED），利用<strong>ChatGPT</strong>来识别LLM的response是否包含反事实错误信息（ED*）。</p><blockquote><p>检索增强生成不是为自动解决给定上下文中的事实错误而设计的，因为这与模型缺乏知识并且依赖于检索到的文档以获取附加信息的基本假设相矛盾。</p><p>然而，由于互联网上假新闻泛滥，这个问题在实际应用中至关重要。现有的 LLM 不具备处理因错误信息造成的不准确回复的保障措施。事实上，它们在很大程度上依赖于检索到的信息。<strong>即使 LLM 包含有关问题的内部知识，它们也经常相信检索到的虚假信息</strong>。这对未来在 LLMs 中发展 RAG 提出了重大挑战。</p></blockquote><p>&lt;font color=#008B8B&gt;</p><h4 id="个人总结"><span class="mr-2">🤹个人总结</span><a href="#个人总结" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img data-src="..\..\..\..\..\zoeChen119.github.io\assets\img023-12-04-RAG检索知识增强\image-20231206113404826.png" alt="image-20231206113404826" data-proofer-ignore></p><p>&lt;/font&gt;</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/nlp/'>NLP</a>, <a href='/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/'>基础知识</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/nlp/" class="post-tag no-text-decoration" >nlp</a> <a href="/tags/rag/" class="post-tag no-text-decoration" >RAG</a> <a href="/tags/%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/" class="post-tag no-text-decoration" >技术综述</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=RAG+-+zoe+Chen&url=https%3A%2F%2Fzoechen119.github.io%2Fposts%2FRAG%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=RAG+-+zoe+Chen&u=https%3A%2F%2Fzoechen119.github.io%2Fposts%2FRAG%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fzoechen119.github.io%2Fposts%2FRAG%2F&text=RAG+-+zoe+Chen" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" data-title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/C25_11%E5%85%A5%E9%97%A8%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%860/">【NLP入门趣味题】肉眼找朋友</a><li><a href="/posts/C25_11%E5%85%A5%E9%97%A8%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%861/">【NLP入门趣味题】探索语言模型与词向量</a><li><a href="/posts/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/">强化学习</a><li><a href="/posts/%E5%A4%9A%E6%A8%A1%E6%80%81%E5%AE%9E%E9%AA%8C/">多模态实验</a><li><a href="/posts/%E5%A4%9A%E6%A8%A1%E6%80%81RAG/">多模态rag</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/nlp/">nlp</a> <a class="post-tag" href="/tags/%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/">技术综述</a> <a class="post-tag" href="/tags/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/">论文笔记</a> <a class="post-tag" href="/tags/rag/">RAG</a> <a class="post-tag" href="/tags/%E8%AF%AD%E8%A8%80%E5%AD%A6/">语言学</a> <a class="post-tag" href="/tags/%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B/">预训练模型</a> <a class="post-tag" href="/tags/bert/">BERT</a> <a class="post-tag" href="/tags/courses/">Courses</a> <a class="post-tag" href="/tags/chatgpt/">ChatGPT</a> <a class="post-tag" href="/tags/mamba/">Mamba</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/RAG%E6%A3%80%E7%B4%A2%E7%9F%A5%E8%AF%86%E5%A2%9E%E5%BC%BA/"><div class="card-body"> <em class="small" data-ts="1708444800" data-df="YYYY-MM-DD" > 2024-02-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RAG</h3><div class="text-muted small"><p> RAG检索知识增强 不完全手册 本文从k个角度对RAG技术进行综述，第一个角度是“范式演变”，即原始的“朴素RAG”-“进阶RAG”-“模块化RAG”，这个角度个人认为是工程的角度、宏观的角度；第二个角度是“关键问题和相关研究”，大类上可分两类“以优化生成模型的表征空间为目的”和“以优化知识密集型问答任务为目的”。 通常“以优化生成模型的表征空间为目的”的这些模型有几个特点：（1）检...</p></div></div></a></div><div class="card"> <a href="/posts/RAG%E6%A3%80%E7%B4%A2%E7%9F%A5%E8%AF%86%E5%A2%9E%E5%BC%BA-(2)/"><div class="card-body"> <em class="small" data-ts="1701619200" data-df="YYYY-MM-DD" > 2023-12-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RAG</h3><div class="text-muted small"><p> RAG调研 一、一些共识 External knowledge is the key to resolving the problems of LLMs such as hallucination and outdated knowledge, which can make LLMs generate more accurate and reliable responses thr...</p></div></div></a></div><div class="card"> <a href="/posts/RAG%E6%A3%80%E7%B4%A2%E7%9F%A5%E8%AF%86%E5%A2%9E%E5%BC%BA/"><div class="card-body"> <em class="small" data-ts="1701619200" data-df="YYYY-MM-DD" > 2023-12-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RAG</h3><div class="text-muted small"><p> RAG调研 一、一些共识 External knowledge is the key to resolving the problems of LLMs such as hallucination and outdated knowledge, which can make LLMs generate more accurate and reliable responses thr...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/RAG%E6%A3%80%E7%B4%A2%E7%9F%A5%E8%AF%86%E5%A2%9E%E5%BC%BA/" class="btn btn-outline-primary" prompt="上一篇"><p>RAG</p></a> <a href="/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-%E7%AC%AC%E4%B8%80%E8%AF%BE/" class="btn btn-outline-primary" prompt="下一篇"><p>深度学习 第一课</p></a></div><script src="https://utteranc.es/client.js" repo="zoeChen119/zoeChen119.github.io" issue-term="title" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/zoeChen119">陈政伊</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/nlp/">nlp</a> <a class="post-tag" href="/tags/%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/">技术综述</a> <a class="post-tag" href="/tags/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/">论文笔记</a> <a class="post-tag" href="/tags/rag/">RAG</a> <a class="post-tag" href="/tags/%E8%AF%AD%E8%A8%80%E5%AD%A6/">语言学</a> <a class="post-tag" href="/tags/%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B/">预训练模型</a> <a class="post-tag" href="/tags/bert/">BERT</a> <a class="post-tag" href="/tags/courses/">Courses</a> <a class="post-tag" href="/tags/chatgpt/">ChatGPT</a> <a class="post-tag" href="/tags/mamba/">Mamba</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">发现新版本的内容。</p><button type="button" class="btn btn-primary" aria-label="Update"> 更新 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/zh.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
